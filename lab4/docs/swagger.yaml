basePath: /api/v1
definitions:
  serializer.CurrentDeviceJSON:
    properties:
      amount:
        type: integer
      amperage:
        type: number
      curr_dev_id:
        type: integer
      current_id:
        type: integer
      device_id:
        type: integer
    type: object
  serializer.CurrentJSON:
    properties:
      created_at:
        type: string
      creator_login:
        type: string
      current_id:
        type: integer
      finish_date:
        type: string
      form_date:
        type: string
      moderator_login:
        type: string
      status:
        type: string
      voltage_bord:
        type: number
    type: object
  serializer.DeviceJSON:
    properties:
      coeff_efficiency:
        type: number
      coeff_reserve:
        type: number
      current_required:
        type: number
      description:
        type: string
      device_id:
        type: integer
      image:
        type: string
      in_stock:
        type: boolean
      is_delete:
        type: boolean
      name:
        type: string
      power_nominal:
        type: number
      resistance:
        type: number
      type:
        type: string
      voltage_nominal:
        type: number
    type: object
  serializer.StatusJSON:
    properties:
      status:
        description: Статус заявки
        type: string
    type: object
  serializer.UserJSON:
    properties:
      id:
        type: string
      is_moderator:
        type: boolean
      login:
        type: string
      password:
        type: string
    type: object
host: localhost
info:
  contact:
    email: support@current.com
    name: API Support
    url: http://localhost
  description: API для определения необходимой силы тока
  license:
    name: MIT
  title: Current API
  version: "1.0"
paths:
  /current-calculations/{id}:
    get:
      description: Возвращает полную информацию о заявке
      parameters:
      - description: ID заявки
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Данные заявки с устройствами
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Неверный ID
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Доступ запрещен
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Заявка не найдено
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Получить заявку по ID
      tags:
      - Currents
  /current-calculations/{id}/delete-current-calculations:
    delete:
      description: Выполняет логическое удаление заявки
      parameters:
      - description: ID заявки
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Статус удаления
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Неверный запрос
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Доступ запрещен
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Заявка не найдена
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Удалить заявка
      tags:
      - Currents
  /current-calculations/{id}/edit-current-calculations:
    put:
      consumes:
      - application/json
      description: Обновляет данные заявки
      parameters:
      - description: ID заявки
        in: path
        name: id
        required: true
        type: integer
      - description: Новые данные заявки
        in: body
        name: current
        required: true
        schema:
          $ref: '#/definitions/serializer.CurrentJSON'
      produces:
      - application/json
      responses:
        "200":
          description: Обновленная заявка
          schema:
            $ref: '#/definitions/serializer.CurrentJSON'
        "400":
          description: Неверные данные
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Заявка не найдена
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Изменить заявка
      tags:
      - Currents
  /current-calculations/{id}/finish:
    put:
      consumes:
      - application/json
      description: Изменяет статус заявки (только для модераторов)
      parameters:
      - description: ID заявки
        in: path
        name: id
        required: true
        type: integer
      - description: Новый статус
        in: body
        name: status
        required: true
        schema:
          $ref: '#/definitions/serializer.StatusJSON'
      produces:
      - application/json
      responses:
        "200":
          description: Результат модерации
          schema:
            $ref: '#/definitions/serializer.CurrentJSON'
        "400":
          description: Неверный запрос
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Доступ запрещен
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Заявка не найдена
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Завершить заявку
      tags:
      - Currents
  /current-calculations/{id}/form:
    put:
      description: Переводит заявку в статус "formed"
      parameters:
      - description: ID заявки
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Сформированная заявка
          schema:
            $ref: '#/definitions/serializer.CurrentJSON'
        "400":
          description: Неверный запрос
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Доступ запрещен
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Заявка не найдена
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Сформировать заявку
      tags:
      - Currents
  /current-calculations/current-calculations:
    get:
      description: Возвращает заявки с возможностью фильтрации по датам и статусу
      parameters:
      - description: Начальная дата (YYYY-MM-DD)
        in: query
        name: from-date
        type: string
      - description: Конечная дата (YYYY-MM-DD)
        in: query
        name: to-date
        type: string
      - description: Статус заявки
        in: query
        name: status
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Список заявок
          schema:
            items:
              $ref: '#/definitions/serializer.CurrentJSON'
            type: array
        "400":
          description: Неверный формат даты
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Получить список заявок на расчёт
      tags:
      - Currents
  /current-calculations/current-cart:
    get:
      description: Возвращает информацию о текущей заявке-черновике на расчёт пользователя
      produces:
      - application/json
      responses:
        "200":
          description: Данные корзины заявки-черновика
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Неверный запрос
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Получить корзину расчёта
      tags:
      - Currents
  /current-devices/{current_id}/{device_id}:
    delete:
      description: Удаляет связь устройства и заявки
      parameters:
      - description: ID устройства
        in: path
        name: device_id
        required: true
        type: integer
      - description: ID заявки
        in: path
        name: current_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Обновленная заявка
          schema:
            $ref: '#/definitions/serializer.CurrentJSON'
        "400":
          description: Неверные ID
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Доступ запрещен
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Не найдено
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Удалить устройство из заявки
      tags:
      - current_devices
    put:
      consumes:
      - application/json
      description: Обновляет параметры устройства в конкретной заявке
      parameters:
      - description: ID устройства
        in: path
        name: device_id
        required: true
        type: integer
      - description: ID заявки
        in: path
        name: current_id
        required: true
        type: integer
      - description: Новые данные
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/serializer.CurrentDeviceJSON'
      produces:
      - application/json
      responses:
        "200":
          description: Обновленные данные
          schema:
            $ref: '#/definitions/serializer.CurrentDeviceJSON'
        "400":
          description: Неверные данные
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Не найдено
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Изменить данные устройства в заявке
      tags:
      - current_devices
  /devices:
    get:
      description: Возвращает все устройства или фильтрует по названию
      parameters:
      - description: Название устройства для поиска
        in: query
        name: device_name
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Список устройств
          schema:
            items:
              $ref: '#/definitions/serializer.DeviceJSON'
            type: array
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Получить список устройств
      tags:
      - devices
  /devices/{id}:
    get:
      description: Возвращает информацию об устройстве по её идентификатору
      parameters:
      - description: ID устройства
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Данные устройства
          schema:
            $ref: '#/definitions/serializer.DeviceJSON'
        "400":
          description: Неверный ID
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Устройство не найдено
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Получить устройство по ID
      tags:
      - devices
  /devices/{id}/add-to-current-calculation:
    post:
      description: Добавляет устройство в заявку-черновик пользователя
      parameters:
      - description: ID устройства
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Расчёт с добавленным устройством
          schema:
            $ref: '#/definitions/serializer.CurrentJSON'
        "201":
          description: Создан новый расчёт
          schema:
            $ref: '#/definitions/serializer.CurrentJSON'
        "400":
          description: Неверный запрос
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Устройство не найдено
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Устройство уже в расчёте
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Добавить устройство в расчёт
      tags:
      - devices
  /devices/{id}/delete-device:
    delete:
      description: Выполняет логическое удаление устройство по ID
      parameters:
      - description: ID устройства
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Статус удаления
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Неверный ID
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Устройство не найдена
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Удалить устройство
      tags:
      - devices
  /devices/{id}/edit-device:
    put:
      consumes:
      - application/json
      description: Обновляет информацию об устройстве по ID
      parameters:
      - description: ID устройства
        in: path
        name: id
        required: true
        type: integer
      - description: Новые данные устройства
        in: body
        name: device
        required: true
        schema:
          $ref: '#/definitions/serializer.DeviceJSON'
      produces:
      - application/json
      responses:
        "200":
          description: Обновленное устройство
          schema:
            $ref: '#/definitions/serializer.DeviceJSON'
        "400":
          description: Неверные данные
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Устройство не найдено
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Изменить данные устройства
      tags:
      - devices
  /devices/{id}/image:
    post:
      consumes:
      - multipart/form-data
      description: Загружает изображение для устройства и возвращает обновленные данные
      parameters:
      - description: ID устройства
        in: path
        name: id
        required: true
        type: integer
      - description: Изображение устройства
        in: formData
        name: image
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: Статус загрузки и данные устройства
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Неверный запрос или файл
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Устройство не найдено
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Загрузить изображение устройства
      tags:
      - devices
  /devices/create-device:
    post:
      consumes:
      - application/json
      description: Создает новое устройство и возвращает его данные
      parameters:
      - description: Данные нового устройства
        in: body
        name: device
        required: true
        schema:
          $ref: '#/definitions/serializer.DeviceJSON'
      produces:
      - application/json
      responses:
        "201":
          description: Созданное устройство
          schema:
            $ref: '#/definitions/serializer.DeviceJSON'
        "400":
          description: Неверные данные
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Создать новое устройство
      tags:
      - devices
  /users/{login}/me:
    get:
      description: Возвращает данные профиля (доступен только тот, чей UUID совпадает
        с user_id в токене).
      parameters:
      - description: Логин пользователя
        in: path
        name: login
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Профиль пользователя
          schema:
            $ref: '#/definitions/serializer.UserJSON'
        "400":
          description: Проблема с авторизацией/получением user_id"}
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Пользователи не совпадают
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Пользователь не найден
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Получить профиль пользователя
      tags:
      - users
    put:
      consumes:
      - application/json
      description: Обновляет профиль пользователя (может делать только сам пользователь).
      parameters:
      - description: Логин пользователя
        in: path
        name: login
        required: true
        type: string
      - description: Новые данные профиля
        in: body
        name: user
        required: true
        schema:
          $ref: '#/definitions/serializer.UserJSON'
      produces:
      - application/json
      responses:
        "200":
          description: Обновлённый профиль
          schema:
            $ref: '#/definitions/serializer.UserJSON'
        "400":
          description: Ошибка запроса или авторизации
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Доступ запрещён
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Пользователь не найден
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Изменить профиль пользователя
      tags:
      - users
  /users/signin:
    post:
      consumes:
      - application/json
      description: Принимает логин/пароль, возвращает jwt-токен в формате {"token":"..."}.
      parameters:
      - description: Логин и пароль
        in: body
        name: credentials
        required: true
        schema:
          $ref: '#/definitions/serializer.UserJSON'
      produces:
      - application/json
      responses:
        "200":
          description: token
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Неверный запрос
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Пользователь не найден
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Вход (получение токена)
      tags:
      - users
  /users/signout:
    post:
      description: Удаляет токен текущего пользователя из хранилища. Возвращает {"status":"signed_out"}.
      produces:
      - application/json
      responses:
        "200":
          description: status
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Проблема с получением user_id
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка при удалении токена
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - ApiKeyAuth: []
      summary: Выход (удаление токена)
      tags:
      - users
  /users/signup:
    post:
      consumes:
      - application/json
      description: Регистрирует нового пользователя. Возвращает URL созданного ресурса
        в Location и тело созданного пользователя.
      parameters:
      - description: Параметры нового пользователя
        in: body
        name: user
        required: true
        schema:
          $ref: '#/definitions/serializer.UserJSON'
      produces:
      - application/json
      responses:
        "201":
          description: Пользователь создан
          schema:
            $ref: '#/definitions/serializer.UserJSON'
        "400":
          description: Ошибка валидации или входных данных
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Внутренняя ошибка сервера
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Регистрация пользователя
      tags:
      - users
securityDefinitions:
  ApiKeyAuth:
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
